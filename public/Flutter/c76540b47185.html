<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- load MUI -->
    <link href="../css/mui.min.css" rel="stylesheet" type="text/css" />
    <script src="../js/mui.min.js"></script>
  </head>
  <body>
    <!-- example content -->
    <div class="mui-container">
      <div class="mui-panel">
          <h1>Custom Implicit Animations in Flutter…with TweenAnimationBuilder</h1>
          
<p>To make animations in Flutter, there are many different options available. How do you choose the right animation widget? This article, <a href="https://medium.com/flutter/flutter-animation-basics-with-implicit-animations-95db481c5916">part</a> of <a href="https://medium.com/flutter/directional-animations-with-built-in-explicit-animations-3e7c5e6fbbd7">our</a> animation series, delves into the best use cases for TweenAnimationBuilder versus when a different widget is best for the job. The previous article in this series explains just how powerful all the built-in implicit animation widgets are and how much you can accomplish with them.</p>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/840/1*1wJWHHPYfOYUCDBAcmIpjg.png"><figcaption>A flow chart for understanding what animation to use in any scenario. This article focuses on the second-from-the-right “end state”, TweenAnimationBuilder.</figcaption></figure><p>Why use TweenAnimationBuilder? Suppose you want to create a <em>basic</em> animation: an animation that <em>doesn’t</em> repeat forever and is just one widget or widget tree. Flutter has a convention of naming its implicitly animated widgets AnimatedFoo, where Foo is the name of the property that animates. Don’t believe me? Here’s a sample of built-in, implicitly animated widgets: AnimatedContainer, AnimatedCrossFade, AnimatedDefaultTextStyle, AnimatedModalBarrier, AnimatedOpacity, AnimatedPadding, AnimatedPhysicalModel, AnimatedPositioned, AnimatedPositionedDirectional, AnimatedSwitcher. This set of widgets is impressively powerful, and you can accomplish a lot of your needs just using those. AnimatedContainer can even let you animate gradients and rotate widgets, all without needing to worry about an AnimationController!</p>
<p>However, if you need to create a basic animation and none of those built-in implicit animations are what you’re looking for, you can still create that animation with TweenAnimationBuilder!</p>
<h3>The basics</h3>
<p>To use TweenAnimationBuilder, I set the length of time that I want my animation to take with the duration parameter, and the range of values that I want it to animate between with the…Tween parameter. As the name suggests, a Tween object enables you to specify a range of values that you want to animate <em>be</em><strong><em>tween</em></strong>.</p>
<p>The last thing I need to specify is the builder parameter, which returns what my animated widget will look like at a given moment in time. This builder function takes a parameter that is the same type as your Tween values, which basically tells Flutter what the current animation value is at a given moment.</p>
<a href="https://medium.com/media/6a0ac9548bfdb29c05be0250cab2f10c/href">https://medium.com/media/6a0ac9548bfdb29c05be0250cab2f10c/href</a><h3>TweenAnimationBuilder in depth</h3>
<p>The example code above showed the bare-minimum set of arguments necessary to use TweenAnimationBuilder, but there is a lot more this widget has to offer! For illustration purposes, I created an app for an extremely common use case: illustration of the Doppler effect in space. Okay, it’s a silly use case, but you might want to apply a color filter to an image and animate the changing colors…which is exactly what we’ll be doing in this scenario.</p>
<p>In the Doppler effect, when a star moves away from you in space, the waves of light elongate, making the light shift closer to the red end of the spectrum. This effect is very subtle and not visible to the naked eye, but astronomers use it to determine the velocity of stars and galaxies relative to us.</p>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/787/1*1-TXNn5MMPC7MDr4OZd-EA.gif"><figcaption>Consult your local astrophysicist for more details.</figcaption></figure><p>In our app we’re going to make this a little less subtle. I have a nice image of a star, and to change its color, I’m going to use the ColorFiltered widget. I apply a blend mode, and tell it to blend orange into the image to make it a little more reddish.</p>
<pre>ColorFiltered(<br>  child: Image.asset('assets/sun.png'),<br>  colorFilter: ColorFilter.mode(color, BlendMode.modulate),<br>)</pre>
<p>Next step…animation! There isn’t a built-in widget that applies an arbitrary color filter to a widget, but we can build one ourselves with TweenAnimationBuilder. To change the color over time, we want to modify the color that we’re applying to the filter. So that’s the value that we’ll animate. We’ll put the ColorFiltered widget inside the builder function of the TweenAnimationBuilder. As I mentioned before, a Tween is just the range of values that we are animating between. In this case, we’ll use a ColorTween to animate between white, which is as if we had no filter, and orange. And there you have it! A nicely animated color filter in 10 lines of code.</p>
<pre>TweenAnimationBuilder(<br>  tween: ColorTween(begin: Colors.white, end: Colors.red),<br>  duration: Duration(seconds: 2),<br>  builder: (_, Color color, __) {<br>    return ColorFiltered(<br>      child: Image.asset('assets/sun.png'),<br>      colorFilter: ColorFilter.mode(color, BlendMode.modulate),<br>    );<br>  },<br>)</pre>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/309/1*_JRebndf4uwMwxVzyNunYg.gif"></figure><p>Depending on <em>what</em> you want to animate though, your Tween can specify ranges between things other than colors or numbers. You can have a Tween with Offset objects to animate the change of a widget’s position, or you can even animate how the border of a widget changes! The point is you have a ton of options.</p>
<p>Tweens are mutable, so if you know that you’re always going to animate between the same set of values, it’s best to declare your Tween as a static final variable in your class. That way, you don’t create a new object every time you rebuild.</p>
<a href="https://medium.com/media/8753a7fc7b6befd1fb3aa3a2c4e0f56a/href">https://medium.com/media/8753a7fc7b6befd1fb3aa3a2c4e0f56a/href</a><h3>Dynamically modifying Tween values</h3>
<p>The previous example showed a really simple way to animate from one value to another without using setState or anything. But, you can do more with TweenAnimationBuilder by <em>dynamically modifying</em> your Tween value.</p>
<a href="https://medium.com/media/f18e75a2f2704f301db06a1da4549f77/href">https://medium.com/media/f18e75a2f2704f301db06a1da4549f77/href</a><p>I changed the code to also include a Slider widget. Then I declared a local variable called _newColor that takes the slider value and converts it to a color. _newColor is also used as the end value in my Tween. Now the animation updates every time I drag the slider.</p>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/309/1*ZiMTAgg11y3BHH24bTt6Mg.gif"></figure><p>One thing to keep in mind is that TweenAnimationBuilder always moves from the current value to the new end value. That means as I drag the slider, I see the color change relative to its previous color, rather than always animating from white at the very beginning. Just by setting a new end value to my Tween, I can reverse my animation or move to any point in between. TweenAnimationBuilder always smoothly animates between its current value and the new end point. As you can perhaps infer, this means dynamically changing the <em>start</em> of your Tween has no effect.</p>
<a href="https://medium.com/media/89ab747597ba02ab52479f754c6d7fb9/href">https://medium.com/media/89ab747597ba02ab52479f754c6d7fb9/href</a><h3>onEnd and child</h3>
<p>There are a few other parameters that I haven’t talked about yet. The first one is the curve, to describe how we should transition between the beginning and end values in our Tween range. In the <a href="https://medium.com/flutter/flutter-animation-basics-with-implicit-animations-95db481c5916">previous article</a> we talked about how you can even create a custom curve, but there are a lot of great predefined options too.</p>
<p>The second one is a callback you can specify, so you can do something when the animation completes. Perhaps you want to make another widget appear after this animation finishes. You can also use this callback as a way to reverse your animation back and forth. I recommend that you think carefully before doing this though. The callback makes the type of animation you’re trying to do less clear because the value setting is distributed through your code. Because the values are discontinuous (jumping back to the start again), if you want a repeating animation you’ll need some sort of explicit animation: either a built-in explicit animated widget or extending AnimatedWidget.</p>
<a href="https://medium.com/media/5eea7d20788b2eb12c1b1d1c233ec83c/href">https://medium.com/media/5eea7d20788b2eb12c1b1d1c233ec83c/href</a><figure><img alt="" src="https://cdn-images-1.medium.com/max/309/1*7xwzsHM8FSwtXlWP_3q9qA.gif"></figure><p>There’s one last parameter we haven’t discussed yet: the child parameter. Setting the child parameter is a potential performance optimization. Even though the color changes, the star image widget itself stays the same. As it’s currently written though, that image widget gets reconstructed every time that builder method gets called. We can build that star image ahead of time by passing it in as a child parameter. This way, Flutter knows the only widget that it needs to rebuild from frame to frame is the new color filter, not the star image itself. This example is simple so there’s really no noticeable difference. But, if we were animating a much more complex component, you can imagine performance optimization might become more important.</p>
<a href="https://medium.com/media/e08c15fd8d812f65ba9ff245958a36fe/href">https://medium.com/media/e08c15fd8d812f65ba9ff245958a36fe/href</a><h3>Summary</h3>
<p>That’s all you need to know to write your own cool implicit animations with TweenAnimationBuilder! To recap, TweenAnimationBuilder is a great way to create “set-it-and-forget-it” implicit animations if you can’t find a built-in AnimatedFoo type widget. You can accomplish simple animations using TweenAnimationBuilder without needing to use a StatefulWidget. You can change that end value in the Tween to smoothly animate to a new value. There are also potential performance optimizations by passing in a child ahead of time or setting a static final Tween when appropriate. To learn more about which animation widget you should use when, check out the other articles in this series.</p>
<p>This is the article version of the following video content. If you prefer videos, watch away:</p>
<a href="https://medium.com/media/dfaa7fb86a51c1ae6105941f388a4ecf/href">https://medium.com/media/dfaa7fb86a51c1ae6105941f388a4ecf/href</a><p>This article is part of a series! Check out the other articles here:</p>
<ul>
<li><a href="https://medium.com/flutter/flutter-animation-basics-with-implicit-animations-95db481c5916">Flutter Animation Basics with Implicit Animations</a></li>
<li><a href="https://medium.com/flutter/custom-implicit-animations-in-flutter-with-tweenanimationbuilder-c76540b47185">Custom Implicit Animations in Flutter … with TweenAnimationBuilder (that’s this article!)</a></li>
<li><a href="https://medium.com/flutter/directional-animations-with-built-in-explicit-animations-3e7c5e6fbbd7">Directional Animations with Built-in Explicit Animations</a></li>
<li>When Should I use AnimatedBuilder or AnimatedWidget (coming soon!)</li>
<li>Bare Metal Explicit Animations (coming soon!)</li>
</ul>
<img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=c76540b47185" width="1" height="1"><hr>
<p><a href="https://medium.com/flutter/custom-implicit-animations-in-flutter-with-tweenanimationbuilder-c76540b47185">Custom Implicit Animations in Flutter…with TweenAnimationBuilder</a> was originally published in <a href="https://medium.com/flutter">Flutter</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>

      </div>
    </div>
  </body>
</html>