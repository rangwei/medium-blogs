<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- load MUI -->
    <link href="http://cdn.muicss.com/mui-0.10.1/css/mui.min.css" rel="stylesheet" type="text/css" />
    <script src="http://cdn.muicss.com/mui-0.10.1/js/mui.min.js"></script>
  </head>
  <body>
    <!-- example content -->
    <div class="mui-container">
      <div class="mui-panel">
          <h1>Directional animations with built-in explicit animations</h1>
          
<p><em>To watch this post in video form, check out our YouTube video </em><a href="https://www.youtube.com/watch?v=CunyH6unILQ&amp;t=1s"><em>here</em></a><em>.</em></p>
<p>Hi! In our <a href="https://medium.com/flutter/flutter-animation-basics-with-implicit-animations-95db481c5916">previous</a> <a href="https://medium.com/flutter/custom-implicit-animations-in-flutter-with-tweenanimationbuilder-c76540b47185">posts</a>, we learned how to do some awesome animations using Flutter’s implicit animations. AnimatedFoo and TweenAnimationBuilder gave you the ability to drop some basic animations into your app. These animations typically go in one direction, “tweening” from a start to an end, where they stop. Behind the scenes, Flutter is taking control, assuming intentions and disposing of any need for you to worry about the transition from one thing to the next.</p>
<p>This works perfectly for many animation goals, but sometimes that ever-forward arrow of time leaves us feeling temporally locked. So, as we pause and contemplate the laws of thermodynamics and the inevitable heat death of the universe, wouldn’t it be nice if we could reverse time, and do it all again?</p>
<p>Enter our first foray into Flutter’s explicit animations! We won’t be building any time machines today, but we will be learning how to gain a bit more control over your animations using Transition widgets.</p>
<p>Transition widgets are a set of Flutter widgets whose names all end in — you guessed it —Transition. <a href="https://api.flutter.dev/flutter/widgets/ScaleTransition-class.html">ScaleTransition</a>, <a href="https://api.flutter.dev/flutter/widgets/DecoratedBoxTransition-class.html">DecoratedBoxTransition</a>, <a href="https://api.flutter.dev/flutter/widgets/SizeTransition-class.html">SizeTransition</a>, and more. They look and feel a lot like our AnimatedBlah widgets. <a href="https://api.flutter.dev/flutter/widgets/PositionedTransition-class.html">PositionedTransition</a>, for example, animates a widget’s transition between different positions. This is much like <a href="https://api.flutter.dev/flutter/widgets/AnimatedPositioned-class.html">AnimatedPositioned</a>, but there is one major difference: these Transition widgets are extensions of <a href="https://api.flutter.dev/flutter/widgets/AnimatedWidget-class.htmlhttps://api.flutter.dev/flutter/widgets/AnimatedWidget-class.html">AnimatedWidget</a>. This makes them <em>explicit animations</em>.</p>
<p>But, what does that really mean for us as app developers? Let’s step through what makes these animations tick.</p>
<p>Here, we’ll be creating an animation of galactic proportions, using this starting image. But, in this initial unanimated state, it doesn’t feel very galactic. Our first quest: to mix in some rotation.</p>
<figure><img alt="An image of Fitz’s galaxy just sitting there, not rotating." src="https://cdn-images-1.medium.com/max/715/0*1xmX3Sfp_rLOAwwl"><figcaption><em>An image of Fitz’s galaxy just sitting there, </em><strong><em>not </em></strong><em>rotating.</em></figcaption></figure><h3>RotationTransition as an example</h3>
<p>The <a href="https://api.flutter.dev/flutter/widgets/RotationTransition-class.html">RotationTransition</a> widget is a handy one that takes care of all of the trigonometry and transformations math to make things spin. Its constructor only takes three things:</p>
<pre>// [Most of] RotationTransition’s constructor<br>RotationTransition({<br>  Widget child,<br>  Alignment alignment,<br>  Animation&lt;double&gt; turns,<br>})</pre>
<p>First is a child —the widget we want to rotate. The galaxy fits, so we’ll put it there:</p>
<pre>RotationTransition(<br>  child: GalaxyFitz(),<br>  alignment: null, /*TODO*/<br>  turns: null, /*TODO*/<br>)</pre>
<p>Next, we need to give RotationTransition the point our galaxy rotates around. Our galaxy’s black hole is roughly in the middle of the image where we’d normally expect. So, we’ll give an alignment of center, making all of our rotational math “aligned” to that point.</p>
<pre>RotationTransition(<br>  child: GalaxyFitz(),<br>  alignment: Alignment.center,<br>  turns: null, /*TODO*/<br>)</pre>
<p>Last, what is this mysteriously named turns property? The API docs tell us this is… an Animation?!? Weren’t we creating an animation?</p>
<figure><img alt="The RotationTransition docs tell us that turns is of type Animation." src="https://cdn-images-1.medium.com/max/467/0*6d-qda9iAUu26wjA"><figcaption><em>The </em><a href="https://api.flutter.dev/flutter/widgets/RotationTransition-class.html">RotationTransition</a><em> docs tell us that turns is of type Animation.</em></figcaption></figure><p>Not to worry! This is part of what makes RotationTransition, and all the other Transition widgets, an explicit animation. We <em>could</em> accomplish the same rotation effect with an AnimatedContainer and a transform, but then we’d rotate once and then stop. With our explicit animations, we have control of time and can make it so that our galaxy never stops spinning.</p>
<figure><img alt="Astronomical tip of the day: Most galaxies take a bit longer than 5 seconds to complete one rotation." src="https://cdn-images-1.medium.com/max/254/0*WOcQ1I3-ThMzDyld"><figcaption><em>Astronomical tip of the day: Most galaxies take </em><strong><em>a bit</em></strong><em> longer than 5 seconds to complete one rotation.</em></figcaption></figure><p>The turns property expects something that gives it a value and notifies it when that value changes. An Animation&lt;double&gt; is just that. For RotationTransition, the value corresponds to how many times we’ve turned, or more specifically, the percentage of one rotation completed.</p>
<figure><img alt="A depiction of 12.6% of a galaxy." src="https://cdn-images-1.medium.com/max/784/0*VO7YjLAkYQsVLIWj"><figcaption><em>It would take the solar system around 30 million years to complete 12.6% of a rotation around the Milky Way. Our Flutter Galaxy will spin </em><strong><em>slightly</em></strong><em> faster than that.</em></figcaption></figure><h3>Creating an AnimationController</h3>
<p>One of the easiest ways to get an Animation&lt;double&gt; is to create an AnimationController, which is a <a href="https://api.flutter.dev/flutter/animation/AnimationController-class.html">controller for an animation</a>. This controller handles listening for ticks¹ and gives us some useful controls over what the animation is doing.</p>
<p>We’ll need to create this in a stateful widget because keeping a handle on the controller will be important in our not-too-distant future. Because AnimationController also has its own state to manage, we initialize it in initState, and dispose of it in dispose.</p>
<a href="https://medium.com/media/2a0270795090d40d432e684daca52c85/href">https://medium.com/media/2a0270795090d40d432e684daca52c85/href</a><p>There are two parameters we must give to AnimationController’s constructor. The first is a duration, which is how long our ̶t̶i̶m̶e̶ ̶m̶a̶c̶h̶i̶n̶e̶ animation lasts. The whole reason we’re here is that we need an object to tell us how far along we are in a single rotation. By default, AnimationController “emits” values from 0.0 to 1.0. How many and how granular those values are depends on how long we want a single rotation to take. Fortunately, Dart gives us a Duration class to use. For the sake of this demo, we should have the galaxy spinning somewhere between 5 seconds and 230 million years per rotation. How about 15 seconds per turn then?</p>
<pre>_animationController = AnimationController(<br>  duration: Duration(seconds: 15),<br>  // TODO: finish constructing me.<br>);</pre>
<p>The next required parameter is vsync. If you’re here from the future, welcome back! We hope you already know everything about vsync. For those who came here from the past, we’ll just say that this is what gives Flutter a reference to the object to notify about changes. this is that thing, and it needs to mix in some ticker provider code. A future post will dive into more detail about vsync and ticker providers.</p>
<a href="https://medium.com/media/8ebd35749e4792877885eadc2b6f456d/href">https://medium.com/media/8ebd35749e4792877885eadc2b6f456d/href</a><p>If we left things at that, nothing much happens. That’s because we’ve been given a controller, but haven’t pushed any of its buttons! We want our galaxy to spin forever, right? For that, we’ll just ask the controller to continually repeat the animation.</p>
<pre>_animationController = AnimationController(<br>  duration: Duration(seconds: 15),<br>  vsync: this,<br>)..repeat();</pre>
<p>Finally, we can go back and replace that null we left lingering around, by passing the animation controller to the turns parameter in our RotationTransition.</p>
<pre>RotationTransition(<br>  child: GalaxyFitz(),<br>  alignment: Alignment.center,<br>  turns: _animationController,<br>)</pre>
<p>And, although we now have an infinitely rotating galaxy, this still doesn’t quite feel like we have control of time. The galaxy just does its thing now, right? Don’t forget, though, we have a handle on a controller. Let’s make use of it.²</p>
<h3>Making use of an AnimationController</h3>
<p>Allowing anyone to control the galaxy seems a bit too permissive though, so I’m going to make it an easter egg. I’ll add a sibling to the galaxy that’s a simple button, hidden off in the corner, and I’ll pass it a reference to our controller, so that within its onTap listener, we can stop or restart the animation.</p>
<a href="https://medium.com/media/b9d38eae73a83da8dd1df542f51beadb/href">https://medium.com/media/b9d38eae73a83da8dd1df542f51beadb/href</a><p>The controller maintains — among other things — the status of the animation, which we can check and stop if we’re running or restart if we’re not. And, there you go! By using an animation controller, we’re able to control the animation on demand. But that’s not all you can do with the controller.</p>
<a href="https://medium.com/media/b658332fdce29fddcffeb1b148d8ec6b/href">https://medium.com/media/b658332fdce29fddcffeb1b148d8ec6b/href</a><p>With it, you can also animate to (or backwards from) a specific value, fling the animation forward with a given velocity, or control multiple animations with the same controller.</p>
<figure><img alt="Keeping your galaxy clean of unwanted rockets." src="https://cdn-images-1.medium.com/max/254/0*UjrF-d2-BWLQyfEo"><figcaption><em>Keeping your galaxy clean of unwanted rockets.</em></figcaption></figure><p>This was just our first taste of explicit animations in Flutter. We saw how a Transition widget works with AnimationController, to provide some directionality and control over how our animation works. In future posts, we’ll be diving deeper into explicit animations and how to get even more customized.</p>
<figure><img alt="When the galaxy stops, everything stops." src="https://cdn-images-1.medium.com/max/254/0*eSjSmRfA6LMzx_Yc"><figcaption><em>When the galaxy stops, everything stops</em></figcaption></figure><ol>
<li><em>Galactic ticks are hard to hear, but AnimationController and TickerProviders help.</em></li>
<li><em>As with all of your time controllers: use responsibly.</em></li>
</ol>
<img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=3e7c5e6fbbd7" width="1" height="1"><hr>
<p><a href="https://medium.com/flutter/directional-animations-with-built-in-explicit-animations-3e7c5e6fbbd7">Directional animations with built-in explicit animations</a> was originally published in <a href="https://medium.com/flutter">Flutter</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>

      </div>
    </div>
  </body>
</html>